

@model IEnumerable<VIVOSHOP.Models.ProductOrder>
@{
    ViewBag.Title = "Sale";
}

<script type="text/javascript">
    function printSelection(node) {
        var content = node.innerHTML
        var pwin = window.open('');
        pwin.document.open();
        pwin.document.write('<html><head>');
        pwin.document.write('<link href="https://fonts.googleapis.com/css?family=Kanit" rel="stylesheet">');
        pwin.document.write('<style>');
        pwin.document.write('* { ');
        pwin.document.write('font-family: "Kanit", sans-serif !important;');
        pwin.document.write('}');
        pwin.document.write('</style>');
        pwin.document.write('<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">');
        pwin.document.write('<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">');
        pwin.document.write('<body onload="window.print()">' + content + '</body></head></html>');
        pwin.document.close();
        if (document.getElementById("print").style.display == "inline") {
            document.getElementById("print").style.display = "none";
        }
        setTimeout(function () {
            pwin.close();
        }, 10000);
    }

</script>


        <form method="get" action="/Report/Sale">
            <div class="row" align="center">
                <div class="col-lg-5">
                    <label class="control-label">
                        ตั้งแต่วันที่: &nbsp;
                    </label>
                    <input class="form-control" type="date" name="gte" id="gte">
                </div>
                <div class="col-lg-5">
                    <label class="control-label">
                        ถึงวันที่: &nbsp; &nbsp; &nbsp;
                    </label>
                    <input class="form-control" type="date" name="lte" id="lte">
                </div>
                    <p> &nbsp; &nbsp; &nbsp;</p>
                    <button type="submit" class="btn btn-light">ค้นหา</button>
            </div>
        </form>



<DIV id="report">
    <center> VIVO SHOP </center>
    <center> รายงานข้อมูลการขาย </center>
    <center>  <p> ชั้น 2 เซนทรัลพลาซ่า นครราชสีมา ตำบลในเมือง อำเภอเมืองนครราชสีมา จังหวัดนครราชสีมา 30000   โทร. 044014230</p> </center>
    @*<p> <b>วันที่พิมพ์ </b>  @DateTime.Now.ToString("dd/MM/yyyy")</p>*@


    <div class="row">
        <div class="col-3">
            <p> <b>วันที่พิมพ์ </b>  @DateTime.Now.ToString("dd/MM/yyyy")</p>
        </div>

        <div class="col-9">
            <div style="align-items: stretch; display: flex;     justify-content: flex-end;">
                <b>ตั้งแต่วันที่:  &nbsp; @ViewBag.gte </b>
                <p> &nbsp; &nbsp; &nbsp;</p>
                <b>ถึงวันที่:  &nbsp; @ViewBag.lte</b>
                <p> &nbsp; &nbsp; &nbsp;</p>
            </div>
        </div>

    </div>
    <hr />

    <table class="table table-striped">
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Order_Id)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Order_Date)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Order_Price)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Order_Status)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Order_Parcel)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.UserAccout.User_Name)
            </th>
        </tr>

        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Order_Id)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Order_Date)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Order_Price)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Order_Status)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Order_Parcel)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.UserAccout.User_Name)
                </td>

            </tr>
        }

    </table>

</DIV>
<center>
    <input name="button6" type="button" value=" - = พิมพ์รายงาน = - " id="print" class="btn-block btn-info"
           onClick="printSelection(document.getElementById('report'))" />
</center>
